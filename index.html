<!DOCTYPE html>
<html = style="height: 100%;">

<head>
	<title>Arathia World Map</title>
	<link rel="icon" href="icons/arathia.png">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="scripts/leaflet.css">
	<link rel="stylesheet" href="scripts/src/leaflet.groupedlayercontrol.css" />
	<link rel="stylesheet" href="scripts/leaflet-search/src/leaflet-search.css" />
	<script src="scripts/leaflet.js"></script>
</head>

<style>
	/* colors  */
	:root {
            --background: #100f0feb;
            --foreground: #9f957e;
            --highlight: #ffe7ab;
			--highlight2: #ddbc6a;
			--highlight-background: #ddbd6a50;
        }

	/* css to customize Leaflet default styles  */
	.leaflet-popup-content-wrapper {
		background: var(--background);
		color: var(--foreground);
		border: 7px solid var(--background);
		border-image-source: url(icons/border.png);
		border-image-width: 20px 40px;
		border-image-repeat: round;
		border-image-slice: 30 50 fill;
		border-radius: 4px;
	}
	.leaflet-popup-content-wrapper a:link {
		color: var(--highlight);
	}
	.leaflet-popup-content-wrapper a:visited {
		color: var(--highlight2);
	}
	.leaflet-control-layers {
		background: var(--background);
		color: var(--foreground);
	}
	.leaflet-top .leaflet-left {
		margin-top: 10px;
	}
	.leaflet-bar a {
		background: var(--background);
		color: var(--foreground);
		border-bottom: 1px solid var(--foreground);
	}
	.leaflet-bar a:hover {
		background: var(--foreground);
		color: var(--background);
	}
	.leaflet-control-layers-toggle {
		background-image: url(icons/layers.png);
		background-size: 30px 30px;
	}
	.leaflet-bar a.leaflet-disabled {
		background: var(--background);
		color: var(--foreground);
	}
	.leaflet-control-layers-selector {
		accent-color: var(--highlight);
	}
	.custom-radio-class {
		margin-top: 2px;
		position: relative;
		top: 1px;
		background-color: initial;
		cursor: default;
		appearance: auto;
		box-sizing: border-box;
		margin: 3px 3px 0px 5px;
		padding: initial;
		border: initial;
		padding-block: 1px;
    	padding-inline: 2px;
		margin-right: 8px;
	}
	.leaflet-control-layers-group-selector {
		accent-color: var(--highlight2);
	}
	.leaflet-popup-tip {
		background: var(--background);
		height: 95%;
	}
	.leaflet-control-layers-separator {
		border-top: 1px solid var(--foreground);
	}
	.leaflet-control-zoom.leaflet-bar.leaflet-control {
		border: 7px solid transparent;
		border-image-source: url(icons/border.png);
		border-image-width: 20px 40px;
		border-image-repeat: round;
		border-image-slice: 30 50 fill;
	}
	.leaflet-control-layers.leaflet-control {
		border-radius: 12px;
		border: 9px solid transparent;
		border-image-source: url(icons/border.png);
		border-image-width: 20px 40px;
		border-image-repeat: round;
		border-image-slice: 30 50 fill;
	}
	.leaflet-control-layers.leaflet-control.leaflet-control-layers-expanded {
		border-radius: 15px;
		border: 12px solid transparent;
		border-image-source: url(icons/border.png);
		border-image-width: 20px 40px;
		border-image-repeat: round;
		border-image-slice: 30 50 fill;
	}
	.leaflet-popup-close-button {
		display: none;
	}

	.custom-container {
			padding:5px;
			border-radius:4px;
			color: var(--foreground);
			margin-top:8px;
        }

        .custom-input {
            margin:2px;
			padding:5px;
			display:block;
			color:var(--foreground);
			background: var(--background);
			border-radius:4px;
			text-decoration:none;	
			white-space:nowrap;
			width:245px;
			accent-color: var(--highlight);
			border: none;
			outline: none;
			border-bottom: 1px solid var(--foreground);
        }

		.custom-checkbox-container {
            display: flex;
            align-items: center;
        }

        .custom-checkbox {
            margin-right: 5px;
			accent-color: var(--highlight);
        }

        .custom-select {
			margin:2px;
            width: 97.5%;
            padding: 5px;
			color:var(--foreground);
			background: var(--background);
			border-radius:4px;
			border: none;
			outline: none;
			border-bottom: 1px solid var(--foreground);
        }

        .custom-button {
            width: 97.5%;
            margin:2px;
			padding: 5px;
			margin-top:8px;
			display:block;
            box-sizing: border-box;
			color:var(--foreground);
			background: var(--background);
			border-radius:4px;
			border: none;
			outline: none;
			border-bottom: 1px solid var(--foreground);
			border-left: 1px solid var(--foreground);
			border-right: 1px solid var(--foreground);
			height: 26px;
        }

		.custom-title {
            width: 97.5%;
            margin:2px;
			padding: 5px;
			display:block;
            box-sizing: border-box;
			color:var(--foreground);
			background: var(--background);
			border-radius:4px;
        }

		.custom-subtitle {
            width: 97.5%;
            margin-left:2px;
			padding-top: 5px;
			display:block;
            box-sizing: border-box;
			color:var(--foreground);
			border-radius:4px;
			text-align: left;
        }

	/* scrollbar */
	::-webkit-scrollbar {
		width: 10px;
	}

	::-webkit-scrollbar-track {
		background: var(--background);
		border-radius: 4px;
	}

	::-webkit-scrollbar-thumb {
		background: var(--foreground);
		border-radius: 4px;
	}

	::-webkit-scrollbar-thumb:hover {
		background: #555;
	}
	</style>

<body style="height: 100%;margin: 0;overflow-y: hidden;overflow-x: hidden;">
	<div id="map" style="width: 100%; height: 100%; background: #31565a;"></div>
	<a class="leaflet-control-zoom-out" href="index" title="Zoom out" role="button"
        aria-label="Zoom out" aria-disabled="false"><span aria-hidden="true">−</span></a>
	<script src="scripts/src/leaflet.groupedlayercontrol.js"></script>
	<script src="scripts/leaflet-search/src/leaflet-search.js"></script>
	<script type="text/javascript">
		function generatePopupContent(title, category, description, linkEnabled, linkTitle) {
			var popupContent = '';

			// Add link if linkEnabled is true
			if (linkEnabled) {
				if (linkTitle) {
					var link = '<a href="wiki#' + encodeURIComponent(linkTitle) + '" target="_blank">';
				} else {
					var link = '<a href="wiki#' + encodeURIComponent(title) + '" target="_blank">';
				}
				
				popupContent += link;
			}
			popupContent += '<b><font size="+0.5">' + title + '</font></b> <br />';

			// Close link tag if linkEnabled is true
			if (linkEnabled) {
				popupContent += '</a>';
			}

			var img1 = '<img style="height:17.5px;width: 100%;min-width: 175px; display: block; margin-left: auto; margin-right: auto; margin-bottom: -8px; margin-top: -4px;" src="icons/divider.png" alt="map popup divider">'
			var img2 = '<img style="height:3px;width: 75%; display: block; margin-left: auto; margin-right: auto; margin-bottom: -14px; margin-top: -2px;" src="icons/divider_small.png" alt="map popup divider">'
			
			popupContent += img1 + ' <i><font size="+0.5">' + category + '</font></i> ' + img2 + ' <br />' + description;

			return popupContent;
		}

		function generateMarker(id, title, category, icon, description, linkEnabled, linkTitle, coords, customId) {
			console.log(category);

			coords = coords.replace('LatLng','');
			coords = coords.replace('(','[');
			coords = coords.replace(')',']');

			var firstTitle = title.replace(/ .*/,'');
			var newId = id + '_'; 
			if (customId) {
				newId += customId;
			} else {
				newId += firstTitle.toLowerCase();
			}

			var output = 'var ' + id + '_'; 
			if (customId) {
				output += customId;
			} else {
				output += firstTitle.toLowerCase();
			}
			
			output += ' = L.marker(' + coords + ', { icon: ' + icon + ", title: '" + title + "', id: " + "'" + newId  + "' }).bindPopup(generatePopupContent('" + title + "', '" + category + "', '" + description + "', ";

			if (linkEnabled) {
				output += 'true';
			} else {
				output += 'false';
			}

			if (linkTitle) {
				output += ", '" + linkTitle + "'));";
			} else {
				output += "));"
			}
			console.log(output)
			return output;
		}

		function generate(output, layers, newId) {
			var layersFinal = ""
				for (var i = 0; i < layers.length; i++) {
					layersFinal += layers[i].options.id + ", ";
				}
				output += layersFinal + newId + "]).addTo(map);";
				console.log(output);
				document.getElementById('LayerGroupOutput').value = output;
		}

		function generateGroups(id, title, customId, icon) {
			var newId = id + '_'; 
			var firstTitle = title.replace(/ .*/,'');
			if (customId) {
				newId += customId;
			} else {
				newId += firstTitle.toLowerCase();
			}

			var output = "";

			if (id == "ar" || id == "od" || id == "th" || id == "rh" || id == "az" || id == "ts" || id == "pr" || id == "dr" || id == "tc" || id == "gi") {
				switch(icon) {
					case 'capital':
						output += "var ar_capitals = L.layerGroup([";
						var layers = ar_capitals.getLayers();
						generate(output, layers, newId);
						break;
					case 'citiesBig':
						output += "var ar_citiesBig = L.layerGroup([";
						var layers = ar_citiesBig.getLayers();
						generate(output, layers, newId);
						break;
					case 'citiesSmall':
						output += "var ar_citiesSmall = L.layerGroup([";
						var layers = ar_citiesSmall.getLayers();
						generate(output, layers, newId);
						break;
					case 'towns':
						output += "var ar_towns = L.layerGroup([";
						var layers = ar_towns.getLayers();
						generate(output, layers, newId);
						break;
					case 'nature':
						output += "var ar_nature = L.layerGroup([";
						var layers = ar_nature.getLayers();
						generate(output, layers, newId);
						break;
					case 'important':
						output += "var ar_important = L.layerGroup([";
						var layers = ar_important.getLayers();
						generate(output, layers, newId);
						break;
					case 'characters':
						output += "var ar_characters = L.layerGroup([";
						var layers = ar_characters.getLayers();
						generate(output, layers, newId);
						break;
					default:
						// code block
					}
			} else {
				switch(icon) {
					case 'capital':
						output += "var mo_capitals = L.layerGroup([";
						var layers = mo_capitals.getLayers();
						generate(output, layers, newId);
						break;
					case 'citiesBig':
						output += "var mo_citiesBig = L.layerGroup([";
						var layers = mo_citiesBig.getLayers();
						generate(output, layers, newId);
						break;
					case 'citiesSmall':
						output += "var mo_citiesSmall = L.layerGroup([";
						var layers = mo_citiesSmall.getLayers();
						generate(output, layers, newId);
						break;
					case 'towns':
						output += "var mo_towns = L.layerGroup([";
						var layers = mo_towns.getLayers();
						generate(output, layers, newId);
						break;
					case 'nature':
						output += "var mo_nature = L.layerGroup([";
						var layers = mo_nature.getLayers();
						generate(output, layers, newId);
						break;
					case 'important':
						output += "var mo_important = L.layerGroup([";
						var layers = mo_important.getLayers();
						generate(output, layers, newId);
						break;
					case 'characters':
						output += "var mo_characters = L.layerGroup([";
						var layers = mo_characters.getLayers();
						generate(output, layers, newId);
						break;
					default:
						// code block
					}
				}
			return output;
		}

		var southWest = L.latLng(-70, -170),
			northEast = L.latLng(70, 170),
			bounds = L.latLngBounds(southWest, northEast);

		//Creating the Map
		var map = L.map('map', {
			maxBounds: bounds,
			zoomSnap: 0.1,
			zoomDelta: 0.5,
			wheelPxPerZoomLevel: 120,
		}).setView([0, 0], 0);

		map.createPane('basePane');
		map.createPane('backgroundPane');

		map.getPane('basePane').style.zIndex = 220;
		map.getPane('backgroundPane').style.zIndex = 150;

		var arathia = L.tileLayer('maps/arathia/{z}/{x}/{y}.png', {
			continuousWorld: false,
			noWrap: true,
			minZoom: 2.75,
			maxZoom: 5.4,
			pane: 'basePane',
		}).addTo(map);
		var arathiaClean = L.tileLayer('maps/arathiaClean/{z}/{x}/{y}.png', {
			continuousWorld: false,
			noWrap: true,
			minZoom: 2.75,
			maxZoom: 5.4,
			pane: 'basePane',
		});
		var morturia = L.tileLayer('maps/morturia/{z}/{x}/{y}.png', {
			continuousWorld: false,
			noWrap: true,
			minZoom: 2.75,
			maxZoom: 5.4,
			pane: 'basePane',
		});
		var arathiaBackground = L.tileLayer('maps/arathiaBackground/{z}/{x}/{y}.png', {
			continuousWorld: false,
			noWrap: false,
			minZoom: 2.75,
			maxZoom: 5.4,
			pane: 'backgroundPane',
		}).addTo(map);

		//Icons
		var capital = L.icon({
			iconUrl: 'icons/capital.png',
			iconRetinaUrl: 'icons/capital.png',
			shadowUrl: 'icons/shadow.png',
			iconSize: [31, 41],
			iconAnchor: [15, 41],
			popupAnchor: [1, -34],
			tooltipAnchor: [16, -28],
			shadowSize: [41, 41]
		});
		var cityBig = L.icon({
			iconUrl: 'icons/cityBig.png',
			iconRetinaUrl: 'icons/cityBig.png',
			shadowUrl: 'icons/shadow.png',
			iconSize: [30, 41],
			iconAnchor: [14, 41],
			popupAnchor: [1, -34],
			tooltipAnchor: [16, -28],
			shadowSize: [41, 41]
		});
		var citySmall = L.icon({
			iconUrl: 'icons/citySmall.png',
			iconRetinaUrl: 'icons/citySmall.png',
			shadowUrl: 'icons/shadow.png',
			iconSize: [30, 41],
			iconAnchor: [14, 41],
			popupAnchor: [1, -34],
			tooltipAnchor: [16, -28],
			shadowSize: [41, 41]
		});
		var town = L.icon({
			iconUrl: 'icons/town.png',
			iconRetinaUrl: 'icons/town.png',
			shadowUrl: 'icons/shadow.png',
			iconSize: [31, 41],
			iconAnchor: [15, 41],
			popupAnchor: [1, -34],
			tooltipAnchor: [16, -28],
			shadowSize: [41, 41]
		});
		var nature = L.icon({
			iconUrl: 'icons/nature.png',
			iconRetinaUrl: 'icons/nature.png',
			shadowUrl: 'icons/shadow.png',
			iconSize: [30, 41],
			iconAnchor: [14, 41],
			popupAnchor: [1, -34],
			tooltipAnchor: [16, -28],
			shadowSize: [41, 41]
		});
		var important = L.icon({
			iconUrl: 'icons/important.png',
			iconRetinaUrl: 'icons/important.png',
			shadowUrl: 'icons/shadow.png',
			iconSize: [27, 41],
			iconAnchor: [13, 41],
			popupAnchor: [1, -34],
			tooltipAnchor: [16, -28],
			shadowSize: [41, 41]
		});
		var character = L.icon({
			iconUrl: 'icons/character.png',
			iconRetinaUrl: 'icons/character.png',
			shadowUrl: 'icons/shadow.png',
			iconSize: [31, 41],
			iconAnchor: [15, 41],
			popupAnchor: [1, -34],
			tooltipAnchor: [16, -28],
			shadowSize: [41, 41]
		});

		//Coordinate Finder
		var marker = L.marker([0, 0], {
			draggable: true,
		});
		marker.on('dragend', function() {
			marker.openPopup();
			markerMaker();
		});

		function markerMaker() {
			var coords = marker.getLatLng().toString();
			coords = coords.replace('LatLng','');
			coords = coords.replace('(','');
			coords = coords.replace(')','');
			var customId = document.getElementById('Coords').value = coords;
			document.getElementById('DevButton').addEventListener('click', function() {
				// Get values from input fields
				var id = document.getElementById('Id').value;
				var title = document.getElementById('Title').value;
				var icon = document.getElementById('Category').value;
				var selectedCategory = document.getElementById('Category'); // not working
				var category = selectedCategory.options[selectedCategory.selectedIndex].id;
				var description = document.getElementById('Description').value;
				var linkEnabled = document.getElementById('Link').checked;
				var linkTitle = document.getElementById('LinkText').value;
				var customId = document.getElementById('CustomId').value;
				var coords = marker.getLatLng().toString();

				// Call the generatePopupContent function
				var output = generateMarker(id, title, category, icon, description, linkEnabled, linkTitle, coords, customId);
				var groupOutput = generateGroups(id, title, customId, icon);

				// Display the output in the 'Output' input field
				document.getElementById('Output').value = output;
			})
		}

		var formHTML = `
			<div class="custom-container">
				<span class="custom-title"><font size="+0.5">Marker Maker</font></span>
				<span class="custom-subtitle"><font size="-1">Coords</font></span>
				<input class="custom-input" type="text" id="Coords" placeholder="Coords"></input>
				<img style="height:3px;width: 100%; display: block; margin-left: auto; margin-right: auto; margin-bottom: 0px; margin-top: 0px;" src="icons/divider_small.png" alt="map popup divider">
				<span class="custom-subtitle"><font size="-1">Country</font></span>
				<select class="custom-select" name="Id" id="Id">
					<option value="ar">Antaria</option>
					<option value="od">Odrheim</option>
					<option value="th">Tunglheimr</option>
					<option value="rh">Rheinland</option>
					<option value="az">Azurith</option>
					<option value="ts">Tsuki</option>
					<option value="pr">Primoria</option>
					<option value="dr">Dryadalis</option>
					<option value="tc">Trade Company</option>
					<option value="gi">Gigantoria</option>
					<option value="ad">Ardeat</option>
					<option value="ge">Gelida</option>
					<option value="sc">Scientia</option>
				</select>
				<input class="custom-input" type="text" id="Title" placeholder="Title"></input>
				<span class="custom-subtitle"><font size="-1">Category</font></span>
				<select class="custom-select" name="Category" id="Category">
					<option value="capital" id="Capital">Capital</option>
					<option value="citiesBig" id="Big City">Big City</option>
					<option value="citiesSmall" id="Small City">Small City</option>
					<option value="towns"id="Town">Town</option>
					<option value="nature" id="Forest">Forest</option>
					<option value="nature" id="Mountain">Mountain</option>
					<option value="nature" id="Cave">Cave</option>
					<option value="important" id="Important Location">Important Location</option>
					<option value="characters" id="Character">Character</option>
					</select>
				<input class="custom-input" type="text" id="Description" placeholder="Description"></input>
				<div class="custom-checkbox-container">
					<input class="custom-checkbox" type="checkbox" id="Link">
					<label for="Link">Link?</label>
				</div>
				<input class="custom-input" type="text" id="LinkText" placeholder="Link Text (optional)"></input>
				<input class="custom-input" type="text" id="CustomId" placeholder="Custom id name (optional)"></input>
				<button class="custom-button" id="DevButton">Generate</button>
				<input class="custom-input" type="text" id="Output" placeholder="Output"></input>
				<input class="custom-input" type="text" id="LayerGroupOutput" placeholder="Layer group output"></input>
			</div>
			`;

		marker.bindPopup(formHTML).openPopup();
		marker.on('click', function(e) {
			markerMaker();
		});
		
		//Arathia	
		//Antaria
		var an_capital = L.marker([32.720989, -41.187598], { icon: capital, title: 'Antaria', id: 'an_capital' }).bindPopup(generatePopupContent('Antaria', 'Capital', 'The capital of the Holy Antarian Enpire', true));
		//Important
		var an_archtree = L.marker([45.04985, -79.242103], { icon: important, title: 'Antarian Arch-Tree', id: 'an_archtree' }).bindPopup(generatePopupContent('Antarian Arch-Tree', 'Important Location', '', true, 'Arch-Trees'));
		//Big Cities
		var an_city = L.marker([12.640338, -35.859375], { icon: cityBig, title: 'Antarian Port City', id: 'an_city' }).bindPopup(generatePopupContent('Antarian Port City', 'Large City', 'A trade city in the HAE with a large port', false));
		//Small Cities
		//Towns
		var an_town = L.marker([-1.841265, -73.559396], { icon: town, title: 'Antarian Town', id: 'an_town' }).bindPopup(generatePopupContent('Antarian Town', 'Town', '', false));
		var an_town2 = L.marker([18.293698, -115.356925], { icon: town, title: 'Antarian Town', id: 'an_town2' }).bindPopup(generatePopupContent('Antarian Town', 'Town', '', false));
		//Nature
		var ar_mountain = L.marker([27.302636, -81.285998], { icon: nature, title: 'Antarian Mountain Range', id: 'ar_mountain' }).bindPopup(generatePopupContent('Antarian Mountain Range', 'Mountain', 'The largest mountain range in Antaria', false));

		//Odrheim
		var od_capital = L.marker([46.588506, 33.414077], { icon: capital, title: 'Odrheim Capital', id: 'od_capital' }).bindPopup(generatePopupContent('Odrheim Capital', 'Capital', 'The capital of Odrheim', false));
		//Important
		//Big Cities
		//Small Cities
		//Towns
		//Nature

		//Tunglheimr
		var th_capital = L.marker([41.364997, 70.145929], { icon: capital, title: 'Tungleheimr Capital', id: 'th_capital' }).bindPopup(generatePopupContent('Tungleheimr Capital', 'Capital', 'The capital of Tunglheimr', false));
		//Important
		//Big Cities
		//Small Cities
		//Towns
		//Nature

		//Rheinland
		var rh_capital = L.marker([15.641359, 138.427261], { icon: capital, title: 'Rheinland Capital', id: 'rh_capital' }).bindPopup(generatePopupContent('Rheinland Capital', 'Capital', 'The capital of Rheinland', false));
		//Important
		var rh_archtree = L.marker([27.803884, 131.965833], { icon: important, title: 'Rheinland Arch-Tree', id: 'rh_archtree' }).bindPopup(generatePopupContent('Rheinland Arch-Tree', 'Important Location', '', true, 'Arch-Trees'));
		//Big Cities
		//Small Cities
		//Towns
		//Nature

		//Golden Order

		//Important
		//Big Cities
		//Small Cities
		//Towns
		//Nature

		//Azurith
		var az_capital = L.marker([-23.271278, 104.100923], { icon: capital, title: 'Azurith Capital', id: 'az_capital' }).bindPopup(generatePopupContent('Azurith Capital', 'Capital', 'The capital of Azurith', false));
		//Important
		//Big Cities
		//Small Cities
		//Towns
		//Nature

		//Tsuki
		var ts_capital = L.marker([-26.786247, 10.234271], { icon: capital, title: 'Getsuyōsei', id: 'ts_capital' }).bindPopup(generatePopupContent('Getsuyōsei', 'Capital', 'The capital of Tsuki Ōkoku', true));
		//Important
		var ts_archtree = L.marker([-17.677522, 10.600598], { icon: important, title: 'Tsuki Arch-Tree', id: 'ts_archtree' }).bindPopup(generatePopupContent('Tsuki Arch-Tree', 'Important Location', 'The Arch-Tree located in the city Getsuyōsei, blossoming in a beautiful blue color.', true, 'Arch-Trees'));
		var ts_mizunoiwaya = L.marker([-52.329725, 58.377932], { icon: important, title: 'Mizu-no-Iwaya', id: 'ts_mizunoiwaya' }).bindPopup(generatePopupContent('Mizu-no-Iwaya', 'Important Location', 'The cave where the first Gekkōjin “Tsukikage Genjiro” sought enlightenment.', false));
		//Big Cities
		var ts_sōgenshima = L.marker([-13.88388, 37.332231], { icon: cityBig, title: 'Sōgenshima', id: 'ts_sōgenshima' }).bindPopup(generatePopupContent('Sōgenshima', 'Large City', '', false));
		var ts_kinshū = L.marker([-34.127172, -11.480145], { icon: cityBig, title: 'Kinshū', id: 'ts_kinshū' }).bindPopup(generatePopupContent('Kinshū', 'Large City', 'A trading city, main trading partners are Trade Company and Primoria.', false));
		var ts_hikari = L.marker([-50.232027, 66.709798], { icon: cityBig, title: 'Hikari no Toshi', id: 'ts_hikari' }).bindPopup(generatePopupContent('Hikari no Toshi', 'Large City', '', false));
		//Small Cities
		var ts_amagumo = L.marker([-32.556313, 28.080238], { icon: citySmall, title: 'Amagumo', id: 'ts_amagumo' }).bindPopup(generatePopupContent('Amagumo', 'Small City', '', false));
		var ts_yozora = L.marker([-60.418733, 26.314855], { icon: citySmall, title: 'Yozora', id: 'ts_yozora' }).bindPopup(generatePopupContent('Yozora', 'Small City', '', false));
		var ts_kōun = L.marker([-17.927417, 65.51944], { icon: citySmall, title: 'Kōun', id: 'ts_kōun' }).bindPopup(generatePopupContent('Kōun', 'Small City', '', false));
		var ts_shingetsu = L.marker([-35.440072, 48.867281], { icon: citySmall, title: 'Shingetsu', id: 'ts_shingetsu' }).bindPopup(generatePopupContent('Shingetsu', 'Small City', '', false));
		var ts_engetsu = L.marker([-45.070751, 14.763658], { icon: citySmall, title: 'Engetsu', id: 'ts_engetsu' }).bindPopup(generatePopupContent('Engetsu', 'Small City', '', false));
		var ts_tsukimiya = L.marker([-40.933431, 81.082085], { icon: citySmall, title: 'Tsukimiya', id: 'ts_tsukimiya' }).bindPopup(generatePopupContent('Tsukimiya', 'Small City', 'Small city, mainly for communication and trade with eastern and northen countries', false));
		//Towns
		var ts_asahi = L.marker([-1.52557, 55.842131], { icon: town, title: 'Asahi', id: 'ts_asahi' }).bindPopup(generatePopupContent('Asahi', 'Town', 'A small town, disproportionately big military presence compared to its civilian population due to its proximity to the HAE', false));
		var ts_yūnagi = L.marker([-38.316604, 56.327448], { icon: town, title: 'Yūnagi', id: 'ts_yūnagi' }).bindPopup(generatePopupContent('Yūnagi', 'Town', '', false));
		var ts_tsukiakari = L.marker([-38.837327, 4.772362], { icon: town, title: 'Tsukiakari', id: 'ts_tsukiakari' }).bindPopup(generatePopupContent('Tsukiakari', 'Town', '', false));
		var ts_suzuran = L.marker([-55.861359, 44.071459], { icon: town, title: 'Suzuran', id: 'ts_suzuran' }).bindPopup(generatePopupContent('Suzuran', 'Town', '', false));
		var ts_yūdachi = L.marker([-40.044885, 3.08464], { icon: town, title: 'Yūdachi', id: 'ts_yūdachi' }).bindPopup(generatePopupContent('Yūdachi', 'Town', '', false));
		var ts_haruka = L.marker([-28.800823, 72.574947], { icon: town, title: 'Haruka', id: 'ts_haruka' }).bindPopup(generatePopupContent('Haruka', 'Town', '', false));
		var ts_kōri = L.marker([-62.13469, 65.332354], { icon: town, title: 'Kōri', id: 'ts_kōri' }).bindPopup(generatePopupContent('Kōri', 'Town', '', false));
		//Nature
		var ts_hanabira = L.marker([-52.306608, 37.804889], { icon: nature, title: 'Hanabira Nagare', id: 'ts_hanabira' }).bindPopup(generatePopupContent('Hanabira Nagare', 'Lake', '', false));
		var ts_yama = L.marker([-36.031332, 57.919922], { icon: nature, title: 'Yama no Kyōfū', id: 'ts_yama' }).bindPopup(generatePopupContent('Yama no Kyōfū', 'Mountain', 'The largest mountain range in Tsuki Ōkoku', false));
		var ts_gekkōzan = L.marker([-30.524413, 37.705078], { icon: nature, title: 'Gekkōzan', id: 'ts_gekkōzan' }).bindPopup(generatePopupContent('Gekkōzan', 'Mountain', '', false));
		var ts_hikarinomori = L.marker([-16.910568, 0.642627], { icon: nature, title: 'Hikari no Mori', id: 'ts_hikarinomori' }).bindPopup(generatePopupContent('Hikari no Mori', 'Forest', '', false));
		var ts_mizuhanabira = L.marker([-50.176898, 50.712891], { icon: nature, title: 'Mizu Hanabira no Mori', id: 'ts_mizuhanabira' }).bindPopup(generatePopupContent('Mizu Hanabira no Mori', 'Forest', '', false));
		var ts_tsukiakari = L.marker([-18.452263, 32.228559], { icon: nature, title: 'Tsukiakari', id: 'ts_tsukiakari' }).bindPopup(generatePopupContent('Tsukiakari', 'Forest', '', false));
		var ts_kori = L.marker([-63.726971, 54.595624], { icon: nature, title: 'Kōri Kaisen', id: 'ts_kori' }).bindPopup(generatePopupContent('Kōri Kaisen', 'Shore', '', false));

		//Primoria
		var pr_capital = L.marker([-26.181457, -61.49786], { icon: capital, title: 'Primorian Capital', id: 'pr_capital' }).bindPopup(generatePopupContent('Primorian Capital', 'Capital', 'The capital of Primoria', false));
		//Important
		var pr_archtree = L.marker([-54.521081, -69.169922], { icon: important, title: 'Primorian Arch-Tree', id: 'pr_archtree' }).bindPopup(generatePopupContent('Primorian Arch-Tree', 'Important Location', 'The Arch-Tree in Primoria', true, 'Arch-Trees'));
		//Big Cities
		//Small Cities
		//Towns
		//Nature

		//Dryadalis
		var dr_capital = L.marker([-39.842286, -136.933594], { icon: capital, title: 'Aeternum', id: 'dr_capital' }).bindPopup(generatePopupContent('Aeternum', 'Capital ', 'The capital of Dryadalis', false));
		//Important
		//Big Cities
		var dr_eldorath = L.marker([-51.123378, -128.277507], { icon: cityBig, title: 'Eldorath', id: 'dr_eldorath' }).bindPopup(generatePopupContent('Eldorath', 'Large City', '', false));
		//Small Cities
		var dr_faerwyn = L.marker([-49.111661, -155.112608], { icon: citySmall, title: 'Faerwyn', id: 'dr_faerwyn' }).bindPopup(generatePopupContent('Faerwyn', 'Small City', '', false));
		//Towns
		var dr_elaris = L.marker([-46.664566, -142.44974], { icon: town, title: 'Elaris', id: 'dr_elaris' }).bindPopup(generatePopupContent('Elaris', 'Town', '', false));
		var dr_galadrim = L.marker([-57.328012, -139.768383], { icon: town, title: 'Galadrim', id: 'dr_galadrim' }).bindPopup(generatePopupContent('Galadrim', 'Town', '', false));
		//Nature
		var dr_feywood = L.marker([-41.435969, -150.186067], { icon: nature, title: 'Feywood', id: 'dr_feywood' }).bindPopup(generatePopupContent('Feywood', 'Forest', '', false));
		var dr_lacus = L.marker([-49.323654, -150.75126], { icon: nature, title: 'Lacus Serenus', id: 'dr_lacus' }).bindPopup(generatePopupContent('Lacus Serenus', 'Lake', '', false));
		var dr_verdantis = L.marker([-42.875964, -142.119141], { icon: nature, title: 'Verdantis Mons', id: 'dr_verdantis' }).bindPopup(generatePopupContent('Verdantis Mons', 'Mountain', '', false));

		//Trade Company

		//Important
		//Big Cities
		//Small Cities
		//Towns
		//Nature

		//Gigantoria

		//Important
		//Big Cities
		//Small Cities
		//Towns
		//Nature

		//Oceans

		//Characters
		var an_gerhard = L.marker([-2.372369, -72.685547], { icon: character, title: 'Gerhard von Eichenwald', id: 'an_gerhard' }).bindPopup(generatePopupContent('Gerhard von Eichenwald', 'Character', 'Gerhards temporary camp in a small town in the Holy Antarian Empire', true, ));
		var ts_nihil = L.marker([-41.980887, 32.348339], { icon: character, title: 'Nihil, the Eternal', id: 'ts_nihil' }).bindPopup(generatePopupContent('Nihil, the Eternal', 'Character ', 'Currently in hiding after the great dragon purge.', true));
		var an_aurumoria = L.marker([17.768594, -114.376119], { icon: character, title: 'Aurumoria, the Gilded Guardian', id: 'an_aurumoria' }).bindPopup(generatePopupContent('Aurumoria, the Gilded Guardian', 'Character ', 'Currently in hiding in a small town after the great dragon purge, has taken human form to blend in.', true));
		var ts_reiko = L.marker([-25.403585, 12.744141], { icon: character, title: 'Miyamoto Reiko', id: 'ts_reiko' }).bindPopup(generatePopupContent('Miyamoto Reiko', 'Character', 'The current leader of Tsuki Ōkoku', true));

		//Morturia
		//Scientia
		var sc_capital = L.marker([39.994442, 89.15887], { icon: capital, title: 'Scienta Capital', id: 'sc_capital' }).bindPopup(generatePopupContent('Scienta Capital', 'Capital', 'The capital of Scientia', false));
		//Important

		//Ardeat
		
		//Important

		//Gelida
		
		//Important

		//Characters

		//Marker Groups
		var ar_capitals = L.layerGroup([an_capital, od_capital, ts_capital, dr_capital, th_capital, rh_capital, pr_capital, az_capital]).addTo(map);
		var ar_citiesBig = L.layerGroup([ts_sōgenshima, ts_kinshū, ts_hikari, an_city, dr_eldorath]).addTo(map);
		var ar_citiesSmall = L.layerGroup([ts_amagumo, ts_yozora, ts_kōun, ts_shingetsu, ts_engetsu, ts_tsukimiya, dr_faerwyn]).addTo(map);
		var ar_towns = L.layerGroup([an_town, an_town2, ts_asahi, ts_yūnagi, ts_tsukiakari, ts_suzuran, ts_yūdachi, ts_haruka, ts_kōri, dr_elaris, dr_galadrim]).addTo(map);
		var ar_nature = L.layerGroup([ts_tsukiakari, ts_hanabira, ts_yama, ts_gekkōzan, ts_hikarinomori, ts_mizuhanabira, ts_kori, dr_feywood, dr_lacus, dr_verdantis, ar_mountain]).addTo(map);
		var ar_important = L.layerGroup([ts_archtree, rh_archtree, an_archtree, pr_archtree, ts_mizunoiwaya]).addTo(map);
		var ar_characters = L.layerGroup([an_gerhard, ts_nihil, an_aurumoria, ts_reiko]).addTo(map);

		var ar_all_layers = L.layerGroup([ar_capitals, ar_citiesBig, ar_citiesSmall, ar_towns, ar_nature, ar_important, ar_characters]);

		var dv_coord = L.layerGroup([marker]);

		var mo_capitals = L.layerGroup([sc_capital]);
		var mo_citiesBig = L.layerGroup([])
		var mo_citiesSmall = L.layerGroup([])
		var mo_towns = L.layerGroup([])
		var mo_nature = L.layerGroup([])
		var mo_important = L.layerGroup([]);
		var mo_characters = L.layerGroup([]);

		var mo_all_layers = L.layerGroup([mo_capitals, mo_citiesBig, mo_citiesSmall, mo_towns, mo_nature,  mo_important, mo_characters]);
		
		//Marker Overlay
		var overlays = {
			"Arathia": {
				"Capitals": ar_capitals,
				"Large Cities": ar_citiesBig,
				"Small Cities": ar_citiesSmall,
				"Towns": ar_towns,
				"Nature": ar_nature,
				"Important Locations": ar_important,
				"Characters": ar_characters,
			},
			"Developer": {
				"Coordinate Finder": dv_coord,
			},
			"Morturia": {
				"Capitals": mo_capitals,
				"Large Cities": mo_citiesBig,
				"Small Cities": mo_citiesSmall,
				"Towns": mo_towns,
				"Nature": mo_nature,
				"Important Locations": mo_important,
				"Characters": mo_characters,
			}
		};
		var options = {
			groupCheckboxes: true
		};
		var mapLayers = {
			"Arathia": arathia,
			"Arathia Clean": arathiaClean,
			"Morturia": morturia,
		}

		//GROUP CONTROLS
		L.control.groupedLayers(mapLayers, overlays, options).addTo(map);

		var controlSearchAr = new L.Control.Search({
			position:'topleft',		
			layer: ar_all_layers, 
			zoom: 5,
			initial: false,
			marker: false
		});
		var controlSearchMo = new L.Control.Search({
			position:'topleft',		
			layer: mo_all_layers, 
			zoom: 5,
			initial: false,
			marker: false
		});

		map.addControl( controlSearchAr );

		var iconChecked = 1;
		var currentMap = 'Arathia';

		document.addEventListener('change', function (event) {
			var radioButton = event.target;

			// Check if the changed element is a radio button
			if (radioButton.classList.contains('leaflet-control-layers-selector')) {
				// Check which radio button is selected
				if (radioButton.nextSibling.textContent.trim() === 'Arathia') {
					currentMap = radioButton.nextSibling.textContent.trim();
					map.getContainer().style.backgroundColor = '#31565a';

					map.addControl(controlSearchAr);
					map.removeControl(controlSearchMo);

					map.removeLayer(mo_all_layers);
					map.addLayer(ar_all_layers);

					map.addLayer(arathiaBackground);

					// Check the main checkbox
					var arathiaCheckbox = document.querySelectorAll('.leaflet-control-layers-group-selector')[0];
					arathiaCheckbox.checked = true;
					addRadioButtons(iconChecked)
				} else if (radioButton.nextSibling.textContent.trim() === 'Arathia Clean') {
					currentMap = radioButton.nextSibling.textContent.trim();
					map.getContainer().style.backgroundColor = '#31565a';

					map.addControl(controlSearchAr);
					map.removeControl(controlSearchMo);

					map.removeLayer(mo_all_layers);
					map.removeLayer(ar_all_layers);

					map.addLayer(arathiaBackground);

					// Uncheck the main checkbox
					var arathiaCheckbox = document.querySelectorAll('.leaflet-control-layers-group-selector')[0];
					arathiaCheckbox.checked = false;
					addRadioButtons(iconChecked)
				} else if (radioButton.nextSibling.textContent.trim() === 'Morturia') {
					currentMap = radioButton.nextSibling.textContent.trim();
					map.getContainer().style.backgroundColor = '#211b16';

					map.removeControl(controlSearchAr);
					map.addControl(controlSearchMo);

					map.removeLayer(ar_all_layers);
					map.addLayer(mo_all_layers);

					map.removeLayer(arathiaBackground);

					// Check the main checkbox
					var morturiaCheckbox = document.querySelectorAll('.leaflet-control-layers-group-selector')[2];
					morturiaCheckbox.checked = true;
					addRadioButtons(iconChecked)
				} else if (radioButton.nextSibling.textContent.trim() === 'Morturia Clean') {
					currentMap = radioButton.nextSibling.textContent.trim();
					map.getContainer().style.backgroundColor = '#211b16';

					map.removeControl(controlSearchAr);
					map.addControl(controlSearchMo);

					map.removeLayer(ar_all_layers);
					map.removeLayer(mo_all_layers);

					map.removeLayer(arathiaBackground);

					// Uncheck the main checkbox
					var morturiaCheckbox = document.querySelectorAll('.leaflet-control-layers-group-selector')[2];
					morturiaCheckbox.checked = false;
					addRadioButtons(iconChecked)
				} 
			} else if (radioButton.classList.contains('custom-radio-class')) {
				if (radioButton.nextSibling.textContent.trim() === 'Default Icons') {
					iconChecked = 1;
					updateIcons(currentMap, iconChecked)
				} else if (radioButton.nextSibling.textContent.trim() === 'Old Icons') {
					iconChecked = 2;
					updateIcons(currentMap, iconChecked)
				} else if (radioButton.nextSibling.textContent.trim() === 'Simple Icons') {
					iconChecked = 3;
					updateIcons(currentMap, iconChecked)
				}
			}
		});

		var oldSuffix = "";

		function changeIcons(layers, suffix) {
			var newIconUrl = layers[1].options.icon.options.iconUrl.replace(oldSuffix, '');
			newIconUrl = newIconUrl.replace(".png", suffix + ".png");
			newIconUrl = newIconUrl.replace(suffix + "icons", "icons");
			console.log(newIconUrl);
			layers[1].options.icon.options.iconUrl = newIconUrl;
		}

		function changeAllIcons(suffix) {
			changeIcons(ar_capitals.getLayers(), suffix);
			changeIcons(ar_citiesBig.getLayers(), suffix);
			changeIcons(ar_citiesSmall.getLayers(), suffix);
			changeIcons(ar_towns.getLayers(), suffix);
			changeIcons(ar_nature.getLayers(), suffix);
			changeIcons(ar_important.getLayers(), suffix);
			changeIcons(ar_characters.getLayers(), suffix);
			oldSuffix = suffix;
		}

		function updateIcons(currentMap, iconChecked) {
			if (iconChecked === 1) {
				changeAllIcons('')
			} else if (iconChecked === 2) {
				changeAllIcons('Old')
			} else if (iconChecked === 3) {
				changeAllIcons('Simple')
			}
			switch (currentMap) {
				case 'Arathia':
					map.removeLayer(ar_all_layers);
					map.addLayer(ar_all_layers);
					var arathiaCheckbox = document.querySelectorAll('.leaflet-control-layers-group-selector')[0];
					arathiaCheckbox.checked = true;
					break;
				case 'Arathia Clean':
					map.addLayer(ar_all_layers);
					map.removeLayer(ar_all_layers);
					var arathiaCheckbox = document.querySelectorAll('.leaflet-control-layers-group-selector')[0];
					arathiaCheckbox.checked = false;
					break;
				case 'Morturia':
					map.removeLayer(mo_all_layers);
					map.addLayer(mo_all_layers);
					var morturiaCheckbox = document.querySelectorAll('.leaflet-control-layers-group-selector')[2];
					morturiaCheckbox.checked = true;
					break;
				case 'Morturia Clean':
					map.addLayer(mo_all_layers);
					map.removeLayer(mo_all_layers);
					var morturiaCheckbox = document.querySelectorAll('.leaflet-control-layers-group-selector')[2];
					morturiaCheckbox.checked = false;
					break;
			}
			addRadioButtons(iconChecked)
		}

		document.addEventListener('DOMContentLoaded', function () {
			// Check the main checkbox
			var checkbox = document.querySelector('.leaflet-control-layers-group-selector');
			checkbox.checked = true;
			addRadioButtons(1)
		});

		// Wait for the DOM to be ready
		function addRadioButtons(checked) {
			// Function to create a radio button
			function createRadioButton(label, value, checked) {
				var radio = document.createElement("input");
				radio.type = "radio";
				radio.name = "layerSelector";
				radio.value = value;

				// Check the radio button if it should be selected by default
				if (checked) {
					radio.checked = true;
				}

				radio.classList.add("custom-radio-class");

				var textNode = document.createTextNode(label);

				var labelElement = document.createElement("label");
				labelElement.appendChild(radio);
				labelElement.appendChild(textNode);

				return labelElement;
			}

			// Get the overlay control container
			var overlayContainer = document.querySelector('.leaflet-control-layers-overlays');

			// Create and append the separator div
			var separatorDiv = document.createElement("div");
			separatorDiv.classList.add("leaflet-control-layers-separator");
			overlayContainer.appendChild(separatorDiv);
			
			// Create and append the first radio button (selected by default)
			if (checked === 1) {
				var radioButton1 = createRadioButton("Default Icons", "option1", true);
				var radioButton2 = createRadioButton("Old Icons", "option2", false);
				var radioButton3 = createRadioButton("Simple Icons", "option3", false);
			} else if (checked === 2) {
				var radioButton1 = createRadioButton("Default Icons", "option1", false);
				var radioButton2 = createRadioButton("Old Icons", "option2", true);
				var radioButton3 = createRadioButton("Simple Icons", "option3", false);
			} else if (checked === 3) {
				var radioButton1 = createRadioButton("Default Icons", "option1", false);
				var radioButton2 = createRadioButton("Old Icons", "option2", false);
				var radioButton3 = createRadioButton("Simple Icons", "option3", true);
			}
			radioButton1.classList.add("leaflet-control-layers-selector");
			overlayContainer.appendChild(radioButton1);
			radioButton2.classList.add("leaflet-control-layers-selector");
			overlayContainer.appendChild(radioButton2);
			radioButton3.classList.add("leaflet-control-layers-selector");
			overlayContainer.appendChild(radioButton3);
		};

		// Injecting the new button into the existing zoom control
		var zoomControl = document.querySelector('.leaflet-control-zoom.leaflet-bar.leaflet-control');
		// Replace the icon URL with the actual URL of the icon you want to use
		const wikiButton = document.createElement('a');
		wikiButton.className = 'leaflet-control-zoom-out';
		wikiButton.href = 'wiki';
		wikiButton.target = '_blank';
		wikiButton.title = 'Wiki';
		wikiButton.role = 'button';
		wikiButton.style.display = 'flex';
		wikiButton.style.justifyContent = 'center';
		wikiButton.style.alignItems = 'center';

		const img = document.createElement('img');
		img.src = 'icons/web1.png';
		// Add a class to the button when hovered
		wikiButton.addEventListener('mouseenter', () => {
			img.src = 'icons/web2.png'; // Change to the hovered icon
		});

		// Remove the class when not hovered
		wikiButton.addEventListener('mouseleave', () => {
			img.src = 'icons/web1.png'; // Change back to the original icon
		});
		img.style.maxWidth = '16px';
		img.style.maxHeight = '16px';

		wikiButton.appendChild(img);

		zoomControl.insertAdjacentElement('beforeend', wikiButton);

		document.getElementsByClassName( 'leaflet-control-attribution' )[0].style.display = 'none';
	</script>		
</body>

</html>