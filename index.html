<!DOCTYPE html>
<html = style="height: 100%;">

<head>
	<title>Arathia World Map</title>
	<link rel="icon" href="icons/arathia.png">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="scripts/leaflet.css">
	<link rel="stylesheet" href="scripts/src/leaflet.groupedlayercontrol.css" />
	<link rel="stylesheet" href="scripts/leaflet-search/src/leaflet-search.css" />
	<script src="scripts/leaflet.js"></script>
</head>

<style>
	/* colors  */
	:root {
            --background: #100f0feb;
            --foreground: #9f957e;
            --highlight: #ffe7ab;
			--highlight2: #ddbc6a;
			--highlight-background: #ddbd6a50;
        }

	/* css to customize Leaflet default styles  */
	.leaflet-popup-content-wrapper {
		background: var(--background);
		color: var(--foreground);
		border: 7px solid var(--background);
		border-image-source: url(icons/border.png);
		border-image-width: 20px 40px;
		border-image-repeat: round;
		border-image-slice: 30 50 fill;
		border-radius: 4px;
	}
	.leaflet-popup-content-wrapper a:link {
		color: var(--highlight);
	}
	.leaflet-popup-content-wrapper a:visited {
		color: var(--highlight2);
	}
	.leaflet-control-layers {
		background: var(--background);
		color: var(--foreground);
	}
	.leaflet-top .leaflet-left {
		margin-top: 10px;
	}
	.leaflet-bar a {
		background: var(--background);
		color: var(--foreground);
		border-bottom: 1px solid var(--foreground);
	}
	.leaflet-bar a:hover {
		background: var(--foreground);
		color: var(--background);
	}
	.leaflet-control-layers-toggle {
		background-image: url(icons/layers.png);
		background-size: 30px 30px;
	}
	.leaflet-bar a.leaflet-disabled {
		background: var(--background);
		color: var(--foreground);
	}
	.leaflet-control-layers-selector {
		accent-color: var(--highlight);
	}
	.custom-radio-class {
		margin-top: 2px;
		position: relative;
		top: 1px;
		background-color: initial;
		cursor: default;
		appearance: auto;
		box-sizing: border-box;
		margin: 3px 3px 0px 5px;
		padding: initial;
		border: initial;
		padding-block: 1px;
    	padding-inline: 2px;
		margin-right: 8px;
	}
	.leaflet-control-layers-group-selector {
		accent-color: var(--highlight2);
	}
	.leaflet-popup-tip {
		background: var(--background);
		height: 95%;
	}
	.leaflet-control-layers-separator {
		border-top: 1px solid var(--foreground);
	}
	.leaflet-control-zoom.leaflet-bar.leaflet-control {
		border: 7px solid transparent;
		border-image-source: url(icons/border.png);
		border-image-width: 20px 40px;
		border-image-repeat: round;
		border-image-slice: 30 50 fill;
	}
	.leaflet-control-layers.leaflet-control {
		border-radius: 12px;
		border: 9px solid transparent;
		border-image-source: url(icons/border.png);
		border-image-width: 20px 40px;
		border-image-repeat: round;
		border-image-slice: 30 50 fill;
	}
	.leaflet-control-layers.leaflet-control.leaflet-control-layers-expanded {
		border-radius: 15px;
		border: 12px solid transparent;
		border-image-source: url(icons/border.png);
		border-image-width: 20px 40px;
		border-image-repeat: round;
		border-image-slice: 30 50 fill;
	}
	.leaflet-popup-close-button {
		display: none;
	}

	.custom-container {
			padding:5px;
			border-radius:4px;
			color: var(--foreground);
			margin-top:8px;
        }

        .custom-input {
            margin:2px;
			padding:5px;
			display:block;
			color:var(--foreground);
			background: var(--background);
			border-radius:4px;
			text-decoration:none;	
			white-space:nowrap;
			width:245px;
			accent-color: var(--highlight);
			border: none;
			outline: none;
			border-bottom: 1px solid var(--foreground);
        }

		.custom-checkbox-container {
            display: flex;
            align-items: center;
        }

        .custom-checkbox {
            margin-right: 5px;
			accent-color: var(--highlight);
        }

        .custom-select {
			margin:2px;
            width: 97.5%;
            padding: 5px;
			color:var(--foreground);
			background: var(--background);
			border-radius:4px;
			border: none;
			outline: none;
			border-bottom: 1px solid var(--foreground);
        }

        .custom-button {
            width: 97.5%;
            margin:2px;
			padding: 5px;
			margin-top:8px;
			display:block;
            box-sizing: border-box;
			color:var(--foreground);
			background: var(--background);
			border-radius:4px;
			border: none;
			outline: none;
			border-bottom: 1px solid var(--foreground);
			border-left: 1px solid var(--foreground);
			border-right: 1px solid var(--foreground);
			height: 26px;
        }

		.custom-title {
            width: 97.5%;
            margin:2px;
			padding: 5px;
			display:block;
            box-sizing: border-box;
			color:var(--foreground);
			background: var(--background);
			border-radius:4px;
        }

		.custom-subtitle {
            width: 97.5%;
            margin-left:2px;
			padding-top: 5px;
			display:block;
            box-sizing: border-box;
			color:var(--foreground);
			border-radius:4px;
			text-align: left;
        }

	/* scrollbar */
	::-webkit-scrollbar {
		width: 10px;
	}

	::-webkit-scrollbar-track {
		background: var(--background);
		border-radius: 4px;
	}

	::-webkit-scrollbar-thumb {
		background: var(--foreground);
		border-radius: 4px;
	}

	::-webkit-scrollbar-thumb:hover {
		background: #555;
	}
	</style>

<body style="height: 100%;margin: 0;overflow-y: hidden;overflow-x: hidden;">
	<div id="map" style="width: 100%; height: 100%; background: #31565a;"></div>
	<a class="leaflet-control-zoom-out" href="index" title="Zoom out" role="button"
        aria-label="Zoom out" aria-disabled="false"><span aria-hidden="true">−</span></a>
	<script src="scripts/src/leaflet.groupedlayercontrol.js"></script>
	<script src="scripts/leaflet-search/src/leaflet-search.js"></script>
	<script type="text/javascript">
		function generatePopupContent(title, category, description, linkEnabled, linkTitle) {
			var popupContent = '';

			// Add link if linkEnabled is true
			popupContent += linkEnabled 
				? `<a href="wiki#${encodeURIComponent(linkTitle || title)}" target="_blank"><b><font size="+0.5">${title}</font></b> <br /></a>`
				: `<b><font size="+0.5">${title}</font></b> <br />`;

			var img1 = '<img style="height:17.5px;width: 100%;min-width: 175px; display: block; margin-left: auto; margin-right: auto; margin-bottom: -8px; margin-top: -4px;" src="icons/divider.png" alt="map popup divider">'
			var img2 = '<img style="height:3px;width: 75%; display: block; margin-left: auto; margin-right: auto; margin-bottom: -14px; margin-top: -2px;" src="icons/divider_small.png" alt="map popup divider">'
			
			popupContent += `${img1}<i><font size="+0.5">${category}</font></i>${img2}<br />${description}`;

			return popupContent;
		}

		const regionMap = {
			"ar": "ar",
			"od": "ar",
			"th": "ar",
			"rh": "ar",
			"az": "ar",
			"ts": "ar",
			"pr": "ar",
			"dr": "ar",
			"tc": "ar",
			"gi": "ar",
		};

		function generateMarker(id, title, category, icon, description, linkEnabled, linkTitle, coords, customId) {
			coords = coords.replace('LatLng','').replace('(','[').replace(')',']');

			var firstTitle = title.split(' ')[0].toLowerCase();
			var newId = `${id}_${customId || firstTitle}`;
			linkTitle = ", '" + linkTitle + "'";

			return `createAndAddMarker('${regionMap[id] || "mo"}', ${coords}, ${icon}, '${title}', '${newId}', generatePopupContent('${title}', '${category}', '${description}', ${linkEnabled}${linkTitle || ''}));`;
		}

		function generate(output, layers, newId) {
			var layersFinal = ""
				for (var i = 0; i < layers.length; i++) {
					layersFinal += layers[i].options.id + ", ";
				}
				document.getElementById('LayerGroupOutput').value = output += layersFinal + newId + "]).addTo(map);";
		}

		var southWest = L.latLng(-70, -170),
			northEast = L.latLng(70, 170),
			bounds = L.latLngBounds(southWest, northEast);

		//Creating the Map
		var map = L.map('map', {
			maxBounds: bounds,
			zoomSnap: 0.1,
			zoomDelta: 0.5,
			wheelPxPerZoomLevel: 120,
		}).setView([0, 0], 0);

		map.createPane('basePane');
		map.createPane('backgroundPane');

		map.getPane('basePane').style.zIndex = 220;
		map.getPane('backgroundPane').style.zIndex = 150;

		function createMap(title, noWrap, minZoom, maxZoom, pane, add) {
			if (add) {
				return L.tileLayer(`maps/${title}/{z}/{x}/{y}.png`, {
					continuousWorld: false,
					noWrap: noWrap,
					minZoom: minZoom,
					maxZoom: maxZoom,
					pane: pane,
				}).addTo(map);
			} else {
				return L.tileLayer(`maps/${title}/{z}/{x}/{y}.png`, {
					continuousWorld: false,
					noWrap: noWrap,
					minZoom: minZoom,
					maxZoom: maxZoom,
					pane: pane,
				});
			}
		}

		function createIcon(icon, iconSize, iconAnchor, popupAnchor) {
			return L.icon({
				iconUrl: `icons/${icon}.png`,
				iconRetinaUrl: `icons/${icon}.png`,
				shadowUrl: 'icons/shadow.png',
				iconSize: iconSize,
				iconAnchor: iconAnchor,
				popupAnchor: popupAnchor,
				tooltipAnchor: [16, -28],
				shadowSize: [41, 41],
				className: icon
			});
		}

		// Maps
		var arathia = createMap('arathia', true, 2.75, 5.4, 'basePane', true);
		var arathiaClean = createMap('arathiaClean', true, 2.75, 5.4, 'basePane', false);
		var morturia = createMap('morturia', true, 2.75, 5.4, 'basePane', false);
		var arathiaBackground = createMap('arathiaBackground', false, 2.75, 5.4, 'backgroundPane', true);
		var morturiaBackground = createMap('morturiaBackground', false, 2.75, 5.4, 'backgroundPane', false);

		// Icons
		var capital = createIcon('capital', [31, 41], [15, 41], [1, -44])
		var cityBig = createIcon('cityBig', [31, 41], [15, 41], [1, -44])
		var citySmall = createIcon('citySmall', [31, 41], [15, 41], [1, -44])
		var town = createIcon('town', [31, 41], [15, 41], [1, -44])
		var nature = createIcon('nature', [31, 41], [15, 41], [1, -44])
		var important = createIcon('important', [31, 41], [15, 41], [1, -44])
		var character = createIcon('character', [31, 41], [15, 41], [1, -44])

		//Coordinate Finder
		var marker = L.marker([0, 0], {
			draggable: true,
		});
		marker.on('dragend', function() {
			marker.openPopup();
			markerMaker();
		});

		function markerMaker() {
			var coords = marker.getLatLng().toString().replace('LatLng','').replace('(','').replace(')','');
			var customId = document.getElementById('Coords').value = coords;
			document.getElementById('DevButton').addEventListener('click', function() {
				// Get values from input fields
				var id = document.getElementById('Id').value;
				var title = document.getElementById('Title').value;
				var icon = document.getElementById('Category').value;
				var selectedCategory = document.getElementById('Category');
				var category = selectedCategory.options[selectedCategory.selectedIndex].id;
				var description = document.getElementById('Description').value;
				var linkEnabled = document.getElementById('Link').checked;
				var linkTitle = document.getElementById('LinkText').value;
				var customId = document.getElementById('CustomId').value;
				var coords = marker.getLatLng().toString();

				// Call the generatePopupContent function
				var output = generateMarker(id, title, category, icon, description, linkEnabled, linkTitle, coords, customId);

				// Display the output in the 'Output' input field
				document.getElementById('Output').value = output;
			})
		}

		var formHTML = `
			<div class="custom-container">
				<span class="custom-title"><font size="+0.5">Marker Maker</font></span>
				<span class="custom-subtitle"><font size="-1">Coords</font></span>
				<input class="custom-input" type="text" id="Coords" placeholder="Coords"></input>
				<img style="height:3px;width: 100%; display: block; margin-left: auto; margin-right: auto; margin-bottom: 0px; margin-top: 0px;" src="icons/divider_small.png" alt="map popup divider">
				<span class="custom-subtitle"><font size="-1">Country</font></span>
				<select class="custom-select" name="Id" id="Id">
					<option value="ar">Antaria</option>
					<option value="od">Odrheim</option>
					<option value="th">Tunglheimr</option>
					<option value="rh">Rheinland</option>
					<option value="az">Azurith</option>
					<option value="ts">Tsuki</option>
					<option value="pr">Primoria</option>
					<option value="dr">Dryadalis</option>
					<option value="tc">Trade Company</option>
					<option value="gi">Gigantoria</option>
					<option value="ad">Ardeat</option>
					<option value="ge">Gelida</option>
					<option value="sc">Scientia</option>
				</select>
				<input class="custom-input" type="text" id="Title" placeholder="Title"></input>
				<span class="custom-subtitle"><font size="-1">Category</font></span>
				<select class="custom-select" name="Category" id="Category">
					<option value="capital" id="Capital">Capital</option>
					<option value="citiesBig" id="Big City">Big City</option>
					<option value="citiesSmall" id="Small City">Small City</option>
					<option value="towns"id="Town">Town</option>
					<option value="nature" id="Forest">Forest</option>
					<option value="nature" id="Mountain">Mountain</option>
					<option value="nature" id="Cave">Cave</option>
					<option value="important" id="Important Location">Important Location</option>
					<option value="characters" id="Character">Character</option>
					</select>
				<input class="custom-input" type="text" id="Description" placeholder="Description"></input>
				<div class="custom-checkbox-container">
					<input class="custom-checkbox" type="checkbox" id="Link">
					<label for="Link">Link?</label>
				</div>
				<input class="custom-input" type="text" id="LinkText" placeholder="Link Text (optional)"></input>
				<input class="custom-input" type="text" id="CustomId" placeholder="Custom id name (optional)"></input>
				<button class="custom-button" id="DevButton">Generate</button>
				<input class="custom-input" type="text" id="Output" placeholder="Output"></input>
			</div>
			`;

		marker.bindPopup(formHTML).openPopup();
		marker.on('click', function(e) {
			markerMaker();
		});

		var regionLayerGroups = {
			'ar': {
				'capital': L.layerGroup().addTo(map),
				'cityBig': L.layerGroup().addTo(map),
				'citySmall': L.layerGroup().addTo(map),
				'town': L.layerGroup().addTo(map),
				'nature': L.layerGroup().addTo(map),
				'important': L.layerGroup().addTo(map),
				'character': L.layerGroup().addTo(map)
			},
			'mo': {
				'capital': L.layerGroup(),
				'cityBig': L.layerGroup(),
				'citySmall': L.layerGroup(),
				'town': L.layerGroup(),
				'nature': L.layerGroup(),
				'important': L.layerGroup(),
				'character': L.layerGroup()
			},
		};

		function createAndAddMarker(region, coords, icon, title, id, popupContent) {
			var marker = L.marker(coords, { icon: icon, title: title, id: id }).bindPopup(popupContent);

			// Automatically add the marker to the correct group based on icon
			if (regionLayerGroups[region] && regionLayerGroups[region][icon.options.className]) {
				regionLayerGroups[region][icon.options.className].addLayer(marker);
			}

			return marker;
		}
		
		//Arathia	
		//Antaria
		createAndAddMarker('ar', [32.720989, -41.187598], capital, 'Antaria', 'an_capital', generatePopupContent('Antaria', 'Capital', 'The capital of the Holy Antarian Enpire', true));
		//Important
		createAndAddMarker('ar', [45.04985, -79.242103], important, 'Antarian Arch-Tree', 'an_archtree', generatePopupContent('Antarian Arch-Tree', 'Important Location', '', true, 'Arch-Trees'));
		//Big Cities
		createAndAddMarker('ar', [12.640338, -35.859375], cityBig, 'Antarian Port City', 'an_city', generatePopupContent('Antarian Port City', 'Large City', 'A trade city in the HAE with a large port', false));
		//Small Cities
		//Towns
		createAndAddMarker('ar', [-1.841265, -73.559396], town, 'Antarian Town', 'an_town', generatePopupContent('Antarian Town', 'Town', '', false));
		createAndAddMarker('ar', [18.293698, -115.356925], town, 'Antarian Town', 'an_town2', generatePopupContent('Antarian Town', 'Town', '', false));
		//Nature
		createAndAddMarker('ar', [27.302636, -81.285998], nature, 'Antarian Mountain Range', 'ar_mountain', generatePopupContent('Antarian Mountain Range', 'Mountain', 'The largest mountain range in Antaria', false));

		//Odrheim
		createAndAddMarker('ar', [46.588506, 33.414077], capital, 'Odrheim Capital', 'od_capital', generatePopupContent('Odrheim Capital', 'Capital', 'The capital of Odrheim', false));
		//Important
		//Big Cities
		//Small Cities
		//Towns
		//Nature

		//Tunglheimr
		createAndAddMarker('ar', [41.364997, 70.145929], capital, 'Tungleheimr Capital', 'th_capital', generatePopupContent('Tungleheimr Capital', 'Capital', 'The capital of Tunglheimr', false));
		//Important
		//Big Cities
		//Small Cities
		//Towns
		//Nature
		
		//Rheinland
		createAndAddMarker('ar', [15.641359, 138.427261], capital, 'Rheinland Capital', 'rh_capital', generatePopupContent('Rheinland Capital', 'Capital', 'The capital of Rheinland', false));
		//Important
		createAndAddMarker('ar', [27.803884, 131.965833], important, 'Rheinland Arch-Tree', 'rh_archtree', generatePopupContent('Rheinland Arch-Tree', 'Important Location', '', true, 'Arch-Trees'));
		//Big Cities
		//Small Cities
		//Towns
		//Nature

		//Golden Order

		//Important
		//Big Cities
		//Small Cities
		//Towns
		//Nature

		//Azurith
		createAndAddMarker('ar', [-23.271278, 104.100923], capital, 'Azurith Capital', 'az_capital', generatePopupContent('Azurith Capital', 'Capital', 'The capital of Azurith', false));
		//Important
		//Big Cities
		//Small Cities
		//Towns
		//Nature

		//Tsuki
		createAndAddMarker('ar', [-26.786247, 10.234271], capital, 'Getsuyōsei', 'ts_capital', generatePopupContent('Getsuyōsei', 'Capital', 'The capital of Tsuki Ōkoku', true));
		//Important
		createAndAddMarker('ar', [-17.677522, 10.600598], important, 'Tsuki Arch-Tree', 'ts_archtree', generatePopupContent('Tsuki Arch-Tree', 'Important Location', 'The Arch-Tree located in the city Getsuyōsei, blossoming in a beautiful blue color.', true, 'Arch-Trees'));
		createAndAddMarker('ar', [-52.329725, 58.377932], important, 'Mizu-no-Iwaya', 'ts_mizunoiwaya', generatePopupContent('Mizu-no-Iwaya', 'Important Location', 'The cave where the first Gekkōjin “Tsukikage Genjiro” sought enlightenment.', false));
		//Big Cities
		createAndAddMarker('ar', [-13.88388, 37.332231], cityBig, 'Sōgenshima', 'ts_sōgenshima', generatePopupContent('Sōgenshima', 'Large City', '', false));
		createAndAddMarker('ar', [-34.127172, -11.480145], cityBig, 'Kinshū', 'ts_kinshū', generatePopupContent('Kinshū', 'Large City', 'A trading city, main trading partners are Trade Company and Primoria.', false));
		createAndAddMarker('ar', [-50.232027, 66.709798], cityBig, 'Hikari no Toshi', 'ts_hikari', generatePopupContent('Hikari no Toshi', 'Large City', '', false));
		//Small Cities
		createAndAddMarker('ar', [-32.556313, 28.080238], citySmall, 'Amagumo', 'ts_amagumo', generatePopupContent('Amagumo', 'Small City', '', false));
		createAndAddMarker('ar', [-60.418733, 26.314855], citySmall, 'Yozora', 'ts_yozora', generatePopupContent('Yozora', 'Small City', '', false));
		createAndAddMarker('ar', [-17.927417, 65.51944], citySmall, 'Kōun', 'ts_kōun', generatePopupContent('Kōun', 'Small City', '', false));
		createAndAddMarker('ar', [-35.440072, 48.867281], citySmall, 'Shingetsu', 'ts_shingetsu', generatePopupContent('Shingetsu', 'Small City', '', false));
		createAndAddMarker('ar', [-45.070751, 14.763658], citySmall, 'Engetsu', 'ts_engetsu', generatePopupContent('Engetsu', 'Small City', '', false));
		createAndAddMarker('ar', [-40.933431, 81.082085], citySmall, 'Tsukimiya', 'ts_tsukimiya', generatePopupContent('Tsukimiya', 'Small City', 'Small city, mainly for communication and trade with eastern and northen countries', false));
		//Towns
		createAndAddMarker('ar', [-1.52557, 55.842131], town, 'Asahi', 'ts_asahi', generatePopupContent('Asahi', 'Town', 'A small town, disproportionately big military presence compared to its civilian population due to its proximity to the HAE', false));
		createAndAddMarker('ar', [-38.316604, 56.327448], town, 'Yūnagi', 'ts_yūnagi', generatePopupContent('Yūnagi', 'Town', '', false));
		createAndAddMarker('ar', [-38.837327, 4.772362], town, 'Tsukiakari', 'ts_tsukiakari', generatePopupContent('Tsukiakari', 'Town', '', false));
		createAndAddMarker('ar', [-55.861359, 44.071459], town, 'Suzuran', 'ts_suzuran', generatePopupContent('Suzuran', 'Town', '', false));
		createAndAddMarker('ar', [-40.044885, 3.08464], town, 'Yūdachi', 'ts_yūdachi', generatePopupContent('Yūdachi', 'Town', '', false));
		createAndAddMarker('ar', [-28.800823, 72.574947], town, 'Haruka', 'ts_haruka', generatePopupContent('Haruka', 'Town', '', false));
		createAndAddMarker('ar', [-62.13469, 65.332354], town, 'Kōri', 'ts_kōri', generatePopupContent('Kōri', 'Town', '', false));
		//Nature
		createAndAddMarker('ar', [-52.306608, 37.804889], nature, 'Hanabira Nagare', 'ts_hanabira', generatePopupContent('Hanabira Nagare', 'Lake', '', false));
		createAndAddMarker('ar', [-36.031332, 57.919922], nature, 'Yama no Kyōfū', 'ts_yama', generatePopupContent('Yama no Kyōfū', 'Mountain', 'The largest mountain range in Tsuki Ōkoku', false));
		createAndAddMarker('ar', [-30.524413, 37.705078], nature, 'Gekkōzan', 'ts_gekkōzan', generatePopupContent('Gekkōzan', 'Mountain', '', false));
		createAndAddMarker('ar', [-16.910568, 0.642627], nature, 'Hikari no Mori', 'ts_hikarinomori', generatePopupContent('Hikari no Mori', 'Forest', '', false));
		createAndAddMarker('ar', [-50.176898, 50.712891], nature, 'Mizu Hanabira no Mori', 'ts_mizuhanabira', generatePopupContent('Mizu Hanabira no Mori', 'Forest', '', false));
		createAndAddMarker('ar', [-18.452263, 32.228559], nature, 'Tsukiakari', 'ts_tsukiakari', generatePopupContent('Tsukiakari', 'Forest', '', false));
		createAndAddMarker('ar', [-63.726971, 54.595624], nature, 'Kōri Kaisen', 'ts_kori', generatePopupContent('Kōri Kaisen', 'Shore', '', false));

		//Primoria
		createAndAddMarker('ar', [-26.181457, -61.49786], capital, 'Primorian Capital', 'pr_capital', generatePopupContent('Primorian Capital', 'Capital', 'The capital of Primoria', false));
		//Important
		createAndAddMarker('ar', [-54.521081, -69.169922], important, 'Primorian Arch-Tree', 'pr_archtree', generatePopupContent('Primorian Arch-Tree', 'Important Location', 'The Arch-Tree in Primoria', true, 'Arch-Trees'));
		//Big Cities
		//Small Cities
		//Towns
		//Nature

		//Dryadalis
		createAndAddMarker('ar', [-39.842286, -136.933594], capital, 'Aeternum', 'dr_capital', generatePopupContent('Aeternum', 'Capital ', 'The capital of Dryadalis', false));
		//Important
		//Big Cities
		createAndAddMarker('ar', [-51.123378, -128.277507], cityBig, 'Eldorath', 'dr_eldorath', generatePopupContent('Eldorath', 'Large City', '', false));
		//Small Cities
		createAndAddMarker('ar', [-49.111661, -155.112608], citySmall, 'Faerwyn', 'dr_faerwyn', generatePopupContent('Faerwyn', 'Small City', '', false));
		//Towns
		createAndAddMarker('ar', [-46.664566, -142.44974], town, 'Elaris', 'dr_elaris', generatePopupContent('Elaris', 'Town', '', false));
		createAndAddMarker('ar', [-57.328012, -139.768383], town, 'Galadrim', 'dr_galadrim', generatePopupContent('Galadrim', 'Town', '', false));
		//Nature
		createAndAddMarker('ar', [-41.435969, -150.186067], nature, 'Feywood', 'dr_feywood', generatePopupContent('Feywood', 'Forest', '', false));
		createAndAddMarker('ar', [-49.323654, -150.75126], nature, 'Lacus Serenus', 'dr_lacus', generatePopupContent('Lacus Serenus', 'Lake', '', false));
		createAndAddMarker('ar', [-42.875964, -142.119141], nature, 'Verdantis Mons', 'dr_verdantis', generatePopupContent('Verdantis Mons', 'Mountain', '', false));

		//Trade Company

		//Important
		//Big Cities
		//Small Cities
		//Towns
		//Nature

		//Gigantoria

		//Important
		//Big Cities
		//Small Cities
		//Towns
		//Nature

		//Oceans

		//Characters
		createAndAddMarker('ar', [-2.372369, -72.685547], character, 'Gerhard von Eichenwald', 'an_gerhard', generatePopupContent('Gerhard von Eichenwald', 'Character', 'Gerhards temporary camp in a small town in the Holy Antarian Empire', true, ));
		createAndAddMarker('ar', [-41.980887, 32.348339], character, 'Nihil, the Eternal', 'ts_nihil', generatePopupContent('Nihil, the Eternal', 'Character ', 'Currently in hiding after the great dragon purge.', true));
		createAndAddMarker('ar', [17.768594, -114.376119], character, 'Aurumoria, the Gilded Guardian', 'an_aurumoria', generatePopupContent('Aurumoria, the Gilded Guardian', 'Character ', 'Currently in hiding in a small town after the great dragon purge, has taken human form to blend in.', true));
		createAndAddMarker('ar', [-25.403585, 12.744141], character, 'Miyamoto Reiko', 'ts_reiko', generatePopupContent('Miyamoto Reiko', 'Character', 'The current leader of Tsuki Ōkoku', true));

		//Morturia
		//Scientia
		createAndAddMarker('mo', [39.994442, 89.15887], capital, 'Scienta Capital', 'sc_capital', generatePopupContent('Scienta Capital', 'Capital', 'The capital of Scientia', false));
		//Important"

		//Ardeat
		
		//Important

		//Gelida
		
		//Important

		//Characters

		//Marker Groups
		var ar_all_layers = L.layerGroup([regionLayerGroups['ar']['capital'], regionLayerGroups['ar']['cityBig'], regionLayerGroups['ar']['citySmall'], regionLayerGroups['ar']['town'], regionLayerGroups['ar']['nature'], regionLayerGroups['ar']['important'], regionLayerGroups['ar']['character']]);

		var dv_coord = L.layerGroup([marker]);

		var mo_all_layers = L.layerGroup([regionLayerGroups['mo']['capital'], regionLayerGroups['mo']['cityBig'], regionLayerGroups['mo']['citySmall'], regionLayerGroups['mo']['town'], regionLayerGroups['mo']['nature'], regionLayerGroups['mo']['important'], regionLayerGroups['mo']['character']]);
		
		//Marker Overlay
		var overlays = {
			"Arathia": {
				"Capitals": regionLayerGroups['ar']['capital'],
				"Large Cities": regionLayerGroups['ar']['cityBig'],
				"Small Cities": regionLayerGroups['ar']['citySmall'],
				"Towns": regionLayerGroups['ar']['town'],
				"Nature": regionLayerGroups['ar']['important'],
				"Important Locations": regionLayerGroups['ar']['important'],
				"Characters": regionLayerGroups['ar']['character'],
			},
			"Developer": {
				"Coordinate Finder": dv_coord,
			},
			"Morturia": {
				"Capitals": regionLayerGroups['mo']['capital'],
				"Large Cities": regionLayerGroups['mo']['cityBig'],
				"Small Cities": regionLayerGroups['mo']['citySmall'],
				"Towns": regionLayerGroups['mo']['town'],
				"Nature": regionLayerGroups['mo']['important'],
				"Important Locations": regionLayerGroups['mo']['important'],
				"Characters": regionLayerGroups['mo']['character'],
			}
		};
		var options = {
			groupCheckboxes: true
		};
		var mapLayers = {
			"Arathia": arathia,
			"Arathia Clean": arathiaClean,
			"Morturia": morturia,
		}

		//GROUP CONTROLS
		L.control.groupedLayers(mapLayers, overlays, options).addTo(map);

		var controlSearchAr = new L.Control.Search({
			position:'topleft',		
			layer: ar_all_layers, 
			zoom: 5,
			initial: false,
			marker: false
		});
		var controlSearchMo = new L.Control.Search({
			position:'topleft',		
			layer: mo_all_layers, 
			zoom: 5,
			initial: false,
			marker: false
		});

		map.addControl( controlSearchAr );

		var iconChecked = 1;
		var currentMap = 'Arathia';

		function updateMapStyles(map, backgroundColor, addControl, removeControl) {
			map.getContainer().style.backgroundColor = backgroundColor;
			map.addControl(addControl);
			map.removeControl(removeControl);
		}

		function updateLayers(map, addLayers, removeLayers) {
			removeLayers.forEach(layer => map.removeLayer(layer));
			addLayers.forEach(layer => map.addLayer(layer));
		}

		function updateCheckbox(selectorIndex, checked) {
			var checkbox = document.querySelectorAll('.leaflet-control-layers-group-selector')[selectorIndex];
			checkbox.checked = checked;
		}

		function getTrimmedText(node) {
			return node.nextSibling.textContent.trim();
		}

		document.addEventListener('change', function (event) {
			var radioButton = event.target;

			if (radioButton.classList.contains('leaflet-control-layers-selector')) {
				currentMap = getTrimmedText(radioButton);
				switch (currentMap) {
					case 'Arathia':
						updateMapStyles(map, '#31565a', controlSearchAr, controlSearchMo);
						updateLayers(map, [ar_all_layers, arathiaBackground], [mo_all_layers, morturiaBackground]);
						updateCheckbox(0, true);
						addRadioButtons(iconChecked);
						break;
					case 'Arathia Clean':
						updateMapStyles(map, '#31565a', controlSearchAr, controlSearchMo);
						updateLayers(map, [arathiaBackground], [mo_all_layers, ar_all_layers, morturiaBackground]);
						updateCheckbox(0, false);
						addRadioButtons(iconChecked);
						break;
					case 'Morturia':
						updateMapStyles(map, '#374539', controlSearchMo, controlSearchAr);
						updateLayers(map, [mo_all_layers, morturiaBackground], [ar_all_layers, arathiaBackground]);
						updateCheckbox(2, true);
						addRadioButtons(iconChecked);
						break;
					case 'Morturia Clean':
						updateMapStyles(map, '#374539', controlSearchMo, controlSearchAr);
						updateLayers(map, [morturiaBackground], [mo_all_layers, ar_all_layers, arathiaBackground]);
						updateCheckbox(2, false);
						addRadioButtons(iconChecked);
						break;
				}
			} else if (radioButton.classList.contains('custom-radio-class')) {
				var iconMap = {
					'Default Icons': 1,
					'Old Icons': 2,
					'Simple Icons': 3
				};
				var iconType = getTrimmedText(radioButton);
				if (iconMap.hasOwnProperty(iconType)) {
					iconChecked = iconMap[iconType];
					updateIcons(currentMap, iconChecked);
				}
			}
		});

		var oldSuffix = "";

		function changeIcons(layers, suffix) {
			var newIconUrl = layers[1].options.icon.options.iconUrl.replace(oldSuffix, '').replace(".png", suffix + ".png").replace(suffix + "icons", "icons");
			layers[1].options.icon.options.iconUrl = newIconUrl;
		}

		function changeAllIcons(suffix) {
			const layerGroups = [ar_capitals, ar_citiesBig, ar_citiesSmall, ar_towns, ar_nature, ar_important, ar_characters];
			layerGroups.forEach(group => changeIcons(group.getLayers(), suffix));
			oldSuffix = suffix;
		}

		function updateCheckbox(selectorIndex, checked) {
			var arathiaCheckbox = document.querySelectorAll('.leaflet-control-layers-group-selector')[selectorIndex];
			arathiaCheckbox.checked = checked;
		}

		function updateIcons(currentMap, iconChecked) {
			const suffixMap = {1: '', 2: 'Old', 3: 'Simple'};
    		changeAllIcons(suffixMap[iconChecked] || '');

			switch (currentMap) {
				case 'Arathia':
					map.removeLayer(ar_all_layers);
					map.addLayer(ar_all_layers);
					updateCheckbox(0, true)
					break;
				case 'Arathia Clean':
					map.addLayer(ar_all_layers);
					map.removeLayer(ar_all_layers);
					updateCheckbox(0, false)
					break;
				case 'Morturia':
					map.removeLayer(mo_all_layers);
					map.addLayer(mo_all_layers);
					updateCheckbox(2, true)
					break;
				case 'Morturia Clean':
					map.addLayer(mo_all_layers);
					map.removeLayer(mo_all_layers);
					updateCheckbox(2, false)
					break;
			}
			addRadioButtons(iconChecked)
		}

		document.addEventListener('DOMContentLoaded', function () {
			// Check the main checkbox
			var checkbox = document.querySelector('.leaflet-control-layers-group-selector');
			checkbox.checked = true;
			addRadioButtons(1)
		});

		// Wait for the DOM to be ready
		function addRadioButtons(checked) {
			// Simplified createRadioButton function
			function createRadioButton(label, value, isChecked) {
				var radio = document.createElement("input");
				radio.type = "radio";
				radio.name = "layerSelector";
				radio.value = value;
				radio.checked = isChecked; // Direct assignment
				radio.classList.add("custom-radio-class");

				var labelElement = document.createElement("label");
				labelElement.appendChild(radio);
				labelElement.appendChild(document.createTextNode(label));
				return labelElement;
			}

			// Get the overlay control container
			var overlayContainer = document.querySelector('.leaflet-control-layers-overlays');

			// Create and append the separator div
			var separatorDiv = document.createElement("div");
			separatorDiv.classList.add("leaflet-control-layers-separator");
			overlayContainer.appendChild(separatorDiv);

			// Radio buttons information
			var radioButtonsInfo = [
				{ label: "Default Icons", option: "option1", checkedIndex: 1 },
				{ label: "Old Icons", option: "option2", checkedIndex: 2 },
				{ label: "Simple Icons", option: "option3", checkedIndex: 3 }
			];

			// Loop to create and append radio buttons
			radioButtonsInfo.forEach(info => {
				var radioButton = createRadioButton(info.label, info.option, checked === info.checkedIndex);
				radioButton.classList.add("leaflet-control-layers-selector");
				overlayContainer.appendChild(radioButton);
			});
		};

		function createWikiButton() {
			const wikiButton = document.createElement('a');
			wikiButton.className = 'leaflet-control-zoom-out';
			wikiButton.href = 'wiki';
			wikiButton.target = '_blank';
			wikiButton.title = 'Wiki';
			wikiButton.role = 'button';
			wikiButton.style.cssText = 'display: flex; justify-content: center; align-items: center;';

			const img = document.createElement('img');
			img.src = 'icons/web1.png';
			img.style.cssText = 'max-width: 16px; max-height: 16px;';

			function toggleIcon(src) {
				img.src = src;
			}

			wikiButton.addEventListener('mouseenter', () => toggleIcon('icons/web2.png'));
			wikiButton.addEventListener('mouseleave', () => toggleIcon('icons/web1.png'));

			wikiButton.appendChild(img);
			return wikiButton;
		}

		const zoomControl = document.querySelector('.leaflet-control-zoom.leaflet-bar.leaflet-control');
		const wikiButton = createWikiButton();
		zoomControl.insertAdjacentElement('beforeend', wikiButton);

		document.getElementsByClassName('leaflet-control-attribution')[0].style.display = 'none';
	</script>		
</body>

</html>